<!DOCTYPE html>
<html lang = "en">
    <head>
        <meta charset="UTF-8">
        <title>Evaluation</title>
    </head>
    <body>
      <label for="relationships">Choose a Relationship</label>

      <select name="relationships" id="relationships">
      </select>

      <label for="employees">Choose an Employee</label>

      <select name="employees" id="employees">
      </select>

      


    <div id = "qa_div">
    </div>


        <script>
        const api_url = 'http://127.0.0.1:8000/evaluation/relationships/';
        xmlhttp=new XMLHttpRequest();
        xmlhttp.open("GET",api_url,false);
        xmlhttp.send();
        relationships = JSON.parse(xmlhttp.responseText);
        drop_down = document.getElementById("relationships");

        text = '';
        for (let i = 0 ;i<relationships.length; i++) {
          id = relationships[i].id
          title = relationships[i].title
          text = `<option value="${id}">${title}</option>`
          drop_down.innerHTML += text          
        }

        const api_url2 = 'http://127.0.0.1:8000/evaluation/employees';
        xmlhttp2=new XMLHttpRequest();
        xmlhttp2.open("GET",api_url2,false);
        xmlhttp2.send()
        employees = JSON.parse(xmlhttp2.responseText);

        
        drop_down2 = document.getElementById("employees");

        for (let i = 0 ;i<employees.length; i++) {
          id = employees[i].id
          first_name = employees[i].first_name
          text = `<option value="${id}">${first_name}</option>`
          drop_down2.innerHTML += text          
        }

        const api_url3 = 'http://127.0.0.1:8000/evaluation/qa';
        xmlhttp3=new XMLHttpRequest();
        xmlhttp3.open("GET",api_url3,false);
        xmlhttp3.send();
        qa = JSON.parse(xmlhttp3.responseText);

        qa_text=''
        div_qa = document.getElementById("qa_div")
        for (let i = 0 ; i<qa.length; i++) {
          question_id = qa[i].q_id
          question_text = qa[i].q_text
          answer_id_1= qa[i].answers[0].a_id
          answer_text_1 = qa[i].answers[0].a_text
          answer_id_2 = qa[i].answers[1].a_id
          answer_text_2 = qa[i].answers[1].a_text
          qa_text =`<p class = '${question_id}'>${question_text}</p>
          <input name = "${question_id}" type="radio" id = '${answer_id_1}'>
          <label for="${answer_id_1}">${answer_text_1}</label>
          <input name = "${question_id}" type="radio" id = '${answer_id_2}'>
          <label for="${answer_id_2}">${answer_text_2}</label>`
          div_qa.innerHTML+= qa_text
        }

        
        
        </script>
    </body>
</html> 
